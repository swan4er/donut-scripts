function removeProtocol(e){return e.replace(/^https?\:\/\//i,"")}let domain=removeProtocol(window.location.origin);function startBlyad(e){params=JSON.parse($("#fake3d").attr("data-params"));let t=$("#fake3d").width(),i=$("#fake3d").height(),a=new PIXI.Application({width:t,height:i});$("#fake3d").append(a.view);let n=new PIXI.Sprite.from(params.img);if(n.width=t,n.height=i,a.stage.addChild(n),null!=e){alert("Используется бесплатная версия. Посетите dev-donut.ru");let e=new PIXI.Sprite.from("https://static.tildacdn.com/tild3835-3731-4465-b036-373561386232/free-overlay.png");e.width=t,e.height=i,a.stage.addChild(e)}depthMap=new PIXI.Sprite.from(params.disp),a.stage.addChild(depthMap),depthMap.width=t,depthMap.height=i,displacementFilter=new PIXI.filters.DisplacementFilter(depthMap),a.stage.filters=[displacementFilter],$(document).on("mousemove",function(e){displacementFilter.scale.x=(t/2-e.clientX)/params.sens,displacementFilter.scale.y=(i/2-e.clientY)/params.sens}),$(document).on("touchstart",function(e){var a=e.originalEvent.changedTouches[0];displacementFilter.scale.x=(t/2-a.clientX)/params.sens,displacementFilter.scale.y=(i/2-a.clientY)/params.sens})}$.post("https://donut-server.ru:8443/lib-domain",{domain:domain}).success(function(e){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.0.2/browser/pixi.min.js",function(){startBlyad()})}).error(function(e){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.0.2/browser/pixi.min.js",function(){["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?startBlyad():startBlyad("free")}),window.open("https://dev-donut.ru/error")});
